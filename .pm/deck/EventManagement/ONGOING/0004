---
#...
# Git-deck card header
# OBS! DON'T REMOVE CARD HEADERS
#...
Title: Spike how to structure working with dev and main branch.
Tags:
Creator:
AssignedTo:
# Time tracker settings
tartAt:
EndAt:
---
The goal of this card is to spike how to work with two branches, dev and main in a structured way,

# DOD (definition of done):
All findings are documented

# TODO:
- [ ] 1. Start to push on a dev branch
- [ ] 2. Create a action to merge the dev branch to the main if a commit passed tests, or had some kind of command message in its commit files.

# Reports:
* The repository will now include three branches.
> |Branch Type|Common Names|
> |:-|:-|
> |Development Branch|`develop`|
> |Main Branch|`main`|
> |Release Branch|`release`|

* Until now all codes were stored/pushed to a main branch, the idea is to use `develop` as a developing branch,
> * All codes on local repo(s) will be committed/pushed to `develop` branches only
> * When a commit is created on the `develop` branch a GitHub action recommit some files such as README and kanban boards files automatically to main.
> * If a commit to `develop` has a specific command in its message. and passes all tests, an other action merges `develop` to `main`
> * One or several action checks the `main` branch commits, if they pass integration tests they will be merged to a `release` branch (updated periodically, such as on a weekly basis.)
> * They can also be merged manually
> * A `release` branch can also implement an auto-downgrade action, allowing for rollbacks of releases based on analytical insights from logs, not now maybe later!

* Some useful commands to work with branches
> ```
> # Confirm A Branch
> git branch
> 
> #Check Out the Main Branch
> git checkout main
> # Pull Latest Changes
> #git pull origin main
> 
> # Create the develop Branch, all current branch files are copied to the new branch , `develop`
> git checkout -b develop
> # It also can create an empty branch and then copy or fetch files manually
> git checkout develop
> # To copy files from a branch to another for example from main to develop
> git checkout main
> git checkout develop -- path/to/file1 path/to/file2
> 
> 
> # Commit on the develop branch (If Needed)
> #git add .
> #git commit -m "Create develop branch and add initial files from main"
> #git push origin develop
> 
> ```

* Summary of Commands
|Action|Command|
|:-|:-|
|Check out Main Branch|`git checkout main`|
|Create Empty Develop Branch|`git branch develop`|
|Switch to Develop Branch|`git checkout develop`|
|Checkout Specific Files from Main|	`git checkout main -- path/to/file`|
|Stage Added Files|`git add path/to/file`|
|Commit Changes|`git commit -m "..."`|

* Apply the idea above to the current repo
> * The `main` is created as an empty branch, GithHub workflow files (`.github` )are only file that can committed manually. It will manage by GitHUb actions from the `develop` branch.
> * A local repo is a clone of the `develop` branch.
> * A `develop` does not need to update DECK files, or run other similar actions, auto generate document and pm files are only generated on the `main` branch.
> * When a commit is pushed to `develop`, some files and folders such as `.pm` and `README.md` will be automatically fetched an re committed to main (from `develop`).
> * The same as today when `.pm` files on the main are changed, an action re-build DECk and other auto generated documents ( on the main),regardless `develop` passes tests or not.
> * When a commit are pushed to the develop, at least to actions are runs, one to test codes (test codes can updated or create repot filed sd README on the develop branch), and an action to auto merge selected files from `develop` to `main`

* What it needs to do on this card to start working on a multi-branches repo
> 1. Create a new `develop`  branch contained all `main`branch files
>>```
>># switch to main, if the current branch is not the main
>>git checkout main
>># Create `develop` with a copy of all files in the current branch (`main`)
>>git checkout -b develop
>>```
> 2. Delete all files from the root of the branch `main`, except for the `.github` directory.
>>```
>># Back to the main branch
>>git checkout main
>>
>># Delet all files and folder except `.github` folder
>>git add -A
>>git commit -m "message"
>>git push origin main
>>
>>git checkout develop
>># Continue working with project con the develop branch
>>```
